<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/paper-checkbox/paper-checkbox.html">
<link rel="import" href="../../bower_components/neon-animation/neon-animations.html">
<link rel="import" href="../../bower_components/neon-animation/neon-animatable.html">
<link rel="import" href="../../bower_components/neon-animated-pages/neon-animated-pages.html">
<link rel="import" href="../../bower_components/paper-tabs/paper-tabs.html">

<dom-module id="genemo-track-filter-pages">
  <template>
    <style include="genemo-shared-styles">
	</style>
    <paper-tabs selected="{{selectedTab}}">
      <paper-tab>Experiment</paper-tab>
      <paper-tab>Tissue</paper-tab>
      <paper-tab>Cell Type</paper-tab>
      <paper-tab>Lab</paper-tab>
    </paper-tabs>
    
    <neon-animated-pages id='listPages' selected="[[selectedTab]]" 
      greater-entry-animation="slide-from-right-animation" 
      greater-exit-animation="slide-left-animation" 
      lesser-entry-animation="slide-from-left-animation" 
      lesser-exit-animation="slide-right-animation">
        <neon-animatable id="expPage">
          <template is="dom-repeat" items="[[expList]]">
            <paper-checkbox noink value="[[index]]">
              <span>[[item.name]]</span>
            </paper-checkbox>
          </template>
        </neon-animatable>
        <neon-animatable id="tissuePage">
          <template is="dom-repeat" items="[[tissueList]]">
            <paper-checkbox noink value="[[index]]">
              <span>[[item.name]]</span>
            </paper-checkbox>
          </template>
        </neon-animatable>
        <neon-animatable id="cellPage">
          <template is="dom-repeat" items="[[cellList]]">
            <paper-checkbox noink value="[[index]]">
              <span>[[item.name]]</span>
            </paper-checkbox>
          </template>
        </neon-animatable>
        <neon-animatable id="labPage">
          <template is="dom-repeat" items="[[labList]]">
            <paper-checkbox noink value="[[index]]">
              <span>[[item.name]]</span>
            </paper-checkbox>
          </template>
        </neon-animatable>
    </neon-animated-pages>
  </template>
  <script>
    Polymer({
		
		is: "genemo-track-filter-pages",
		
		properties: {
			
			selectedTab: {
				type: Number,
				value: 0,
			},
			
			initialized: {
				type: Boolean,
				value: false,
				readOnly: true,
			},
			
			expList: {
				type: Array,
				value: function() {
					return [];
				},
			},
			
			cellTypeList: {
				type: Array,
				value: function() {
					return [];
				},
			},
			
			tissueList: {
				type: Array,
				value: function() {
					return [];
				},
			},
			
			labList: {
				type: Array,
				value: function() {
					return [];
				},
			},
			
			listOfLists: {
				type: Array,
				value: function() {
					return [];
				},
			},
			
		},
		
		initialize: function(expMap, cellTypeMap, tissueMap, labMap) {
			
			this.listOfLists.splice(0, this.listOfLists.length);
			
			this.splice('expList', 0, this.expList.length);
			for(key in expMap) {
				if(expMap.hasOwnProperty(key)) {
					this.push('expList', { name: expMap[key].name, ids: expMap[key] });
				}
			}
			this.listOfLists.push(this.expList);
			
			this.splice('tissueList', 0, this.tissueList.length);
			for(key in tissueMap) {
				if(tissueMap.hasOwnProperty(key)) {
					this.push('tissueList', { name: key, ids: tissueMap[key] });
				}
			}
			this.listOfLists.push(this.tissueList);
			
			this.splice('cellTypeList', 0, this.cellTypeList.length);
			for(key in cellTypeMap) {
				if(cellTypeMap.hasOwnProperty(key)) {
					this.push('cellTypeList', { name: key, ids: cellTypeMap[key] });
				}
			}
			this.listOfLists.push(this.cellTypeList);
			
			this.splice('labList', 0, this.labList.length);
			for(key in labMap) {
				if(labMap.hasOwnProperty(key)) {
					this.push('labList', { name: key, ids: labMap[key] });
				}
			}
			this.listOfLists.push(this.labList);
			
			this._setInitialized(true);
		},
		
		getCurrentList: function() {
			// get the ids that corresponding to the current selection
			var result = [], checkboxList = Polymer.dom(this.$.listPages.selectedItem).querySelectorAll('paper-checkbox');
			checkboxList.forEach(function(checkbox, index) {
				if(checkbox.checked) {
					result.concat(this.listOfLists[this.selectedTab][index].ids);
				}
			}, this);
			
			return result;
		},
		
    });
  </script>
</dom-module>